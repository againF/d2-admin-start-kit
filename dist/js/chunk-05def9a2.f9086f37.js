(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05def9a2"],{"30e3":function(e,t,o){"use strict";o("8336")},"4ffd":function(e,t,o){e.exports=o.p+"img/logo.95127bdc.png"},8336:function(e,t,o){},c3d9:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"loginApp"}},[o("div",{staticClass:"down-load-btn",on:{click:e.goToRegister}},[e._v("申请加入")]),o("div",{staticClass:"hight-pl"}),o("div",{staticClass:"flex-vc"},[o("div",{staticClass:"main-area"},[e._m(0),o("div",{staticClass:"login-area"},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.isLogin,expression:"isLogin"}],staticClass:"vc"},[o("div",{staticClass:"l-title"},[e._v("Mysitefy伙伴平台登录")]),o("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[o("div",{staticClass:"input-wrap"},[o("div",{staticClass:"input-label"},[e._v("手机号")]),o("el-form-item",{attrs:{prop:"phoneMsg"}},[o("el-input",{staticClass:"cus-input",attrs:{placeholder:"请输入手机号",clearable:""},model:{value:e.ruleForm.phoneMsg,callback:function(t){e.$set(e.ruleForm,"phoneMsg",t)},expression:"ruleForm.phoneMsg"}})],1)],1),o("div",{staticClass:"input-wrap"},[o("div",{staticClass:"input-label"},[e._v("验证码")]),o("el-form-item",{attrs:{prop:"codeMsg"}},[o("div",{staticClass:"flex-x"},[o("el-input",{staticClass:"cus-input flex-basis50",attrs:{placeholder:"请输入验证码",clearable:""},model:{value:e.ruleForm.codeMsg,callback:function(t){e.$set(e.ruleForm,"codeMsg",t)},expression:"ruleForm.codeMsg"}}),o("div",{staticClass:"get-code",class:e.isPhone&&e.isGetCodeState?"getCodeBtnActive":"",on:{click:e.handleGetCode}},[e._v(" "+e._s(e.codeText)+" ")])],1)])],1)]),o("div",{staticClass:"login-btn",class:e.disBtn,on:{click:function(t){return e.handleLogin("ruleForm")}}},[e._v(" 登录 ")])],1)])])]),o("div",{staticStyle:{height:"110px"}})])},n=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"logo-row"},[s("img",{staticClass:"logo-img",attrs:{src:o("4ffd"),alt:"logo"}})])}],i=o("ed3b"),a=(o("e186"),o("bb4d"),o("94c2"),o("1576"),o("62ab")),r=o("c276"),c={name:"login",components:{},data:function(){var e=this,t=function(t,o,s){var n=/^((13|14|15|16|17|18|19)[0-9]{1}\d{8})$/;n.test(o)?(e.isPhone=!0,s()):(e.isPhone=!1,s(new Error("请输入正确的手机号")))};return{downloadShow:!1,ruleForm:{phoneMsg:"",codeMsg:""},rules:{phoneMsg:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:t,trigger:"blur"}],codeMsg:[{required:!0,message:"请输入验证码",trigger:"blur"}]},isPhone:!1,Countdown:60,isGetCodeState:!0,codeText:"获取验证码",timer:null,showCanLogin:!1,showLoginSuccess:!1,isLogin:!0,companyList:[]}},computed:{disBtn:function(){return this.ruleForm.phoneMsg&&this.ruleForm.codeMsg?"":{"disable-btn":!0}}},mounted:function(){},methods:{goToRegister:function(){this.$router.push({name:"register"})},handleLogin:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;Object(a["a"])({url:"/admin/login",method:"post",params:{mobile:t.ruleForm.phoneMsg,code:t.ruleForm.codeMsg,type:"mobile_login_code"}},(function(e){200===e.status_code&&(r["a"].cookies.set("token",e.data),t.getUserInfo(),t.getCompanyList().then((function(){t.companyList.length>1?t.$router.push({name:"chooseTeam",params:{companyList:t.companyList}}):t.$router.push({name:"website"})})))}))}))},getUserInfo:function(){var e=this;Object(a["a"])({method:"get",url:"/user/info"},(function(t){r["a"].cookies.set("uuid",t.data.uid),e.$store.dispatch("d2admin/user/set",{name:t.data.username},{root:!0})}))},getCompanyList:function(){var e=this;return new Promise((function(t,o){Object(a["a"])({url:"/enterprise/list",method:"post",params:{}},(function(o){e.companyList=o.data,t()}))}))},toggleDownload:function(){this.downloadShow=!this.downloadShow},handleGetCode:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isGetCodeState){t.next=2;break}return t.abrupt("return");case 2:if(e.isPhone){t.next=5;break}return alert("请确定手机号码是否正确!"),t.abrupt("return");case 5:Object(a["a"])({url:"/admin/captcha",method:"post",params:{mobile:e.ruleForm.phoneMsg,type:"mobile_login_code"}},(function(t){!0===t.data&&(e.$message.success("验证码发送成功"),e.handelCountdown())}));case 6:case"end":return t.stop()}}),t)})))()},handelCountdown:function(){var e=this;this.codeText="".concat(this.Countdown,"s后重新获取"),this.isGetCodeState=!1,this.timer=setInterval((function(){e.Countdown-=1,e.codeText="".concat(e.Countdown,"s后重新获取"),0===e.Countdown&&(e.codeText="获取验证码",e.isGetCodeState=!0,e.Countdown=60,clearInterval(e.timer))}),1e3)}}},l=c,u=(o("30e3"),o("cba8")),d=Object(u["a"])(l,s,n,!1,null,null,null);t["default"]=d.exports}}]);